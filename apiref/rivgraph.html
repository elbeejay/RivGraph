

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rivgraph &mdash; RivGraph 0.3 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="deltas" href="deltas.html" />
    <link rel="prev" title="API Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background/index.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">rivgraph</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classes-py">classes.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directionality">directionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="#im-utils">im_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#io-utils">io_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ln-utils">ln_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ordered-set">ordered_set</a></li>
<li class="toctree-l3"><a class="reference internal" href="#walk-py">walk.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deltas.html">deltas</a></li>
<li class="toctree-l2"><a class="reference internal" href="rivers.html">rivers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RivGraph</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Reference</a> &raquo;</li>
        
      <li>rivgraph</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/apiref/rivgraph.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rivgraph">
<span id="id1"></span><h1>rivgraph<a class="headerlink" href="#rivgraph" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-rivgraph.classes"></span><div class="section" id="classes-py">
<h2>classes.py<a class="headerlink" href="#classes-py" title="Permalink to this headline">¶</a></h2>
<p>Classes for running rivgraph commands on your channel network.</p>
<dl class="class">
<dt id="rivgraph.classes.delta">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">delta</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to manage and organize data and methods for analyzing a delta channel network.
This class inherets all the attributes and methods of the rivnetwork class,
but also includes delta-specific attributes and methods.</p>
<dl class="attribute">
<dt id="rivgraph.classes.delta.Iskel">
<code class="descname">Iskel</code><a class="headerlink" href="#rivgraph.classes.delta.Iskel" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the skeletonized binary mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.delta.topo_metrics">
<code class="descname">topo_metrics</code><a class="headerlink" href="#rivgraph.classes.delta.topo_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a number of connectivity and network metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the delta channel network; also defines the folder name for storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>verbose</strong> (<em>str</em><em>, </em><em>optional</em>) – RivGraph will output processing progress if ‘True’. Default is ‘False’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.assign_flow_directions">
<code class="descname">assign_flow_directions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.assign_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.assign_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes flow directions for each link in the delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.compute_topologic_metrics">
<code class="descname">compute_topologic_metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.compute_topologic_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.compute_topologic_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a suite of connectivity and network metrics for a delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.prune_network">
<code class="descname">prune_network</code><span class="sig-paren">(</span><em>path_shoreline=None</em>, <em>path_inletnodes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.prune_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.prune_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Prunes the delta by removing spurs and links beyond the provided shoreline.
Paths may be provided to shoreline and inlet nodes shapefiles, otherwise
their location is specified by paths dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_shoreline</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to shoreline shapefile/geosjon. The default is None but will
check for the file at paths[‘shoreline’].</p></li>
<li><p><strong>path_inletnodes</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to inlet nodes shapefile/geojson. The default is None but will
check for the file at paths[‘inlet_nodes’].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None, but saves pruned links and nodes dictionaries to class object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.delta.skeletonize">
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#delta.skeletonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.delta.skeletonize" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes the delta binary mask.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rivgraph.classes.river">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">river</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to manage and organize data and methods for analyzing a braided river channel network.
This class inherets all the attributes and methods of the rivnewtwork class, but also includes delta-specific attributes and methods.</p>
<p>…</p>
<dl class="attribute">
<dt id="rivgraph.classes.river.Iskel">
<code class="descname">Iskel</code><a class="headerlink" href="#rivgraph.classes.river.Iskel" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the skeletonized binary mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.topo_metrics">
<code class="descname">topo_metrics</code><a class="headerlink" href="#rivgraph.classes.river.topo_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a number of connectivity and network metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.centerline">
<code class="descname">centerline</code><a class="headerlink" href="#rivgraph.classes.river.centerline" title="Permalink to this definition">¶</a></dt>
<dd><p>Centerline of the holes-filled river channel network mask. First element in tuple are x-coordinates; second are y-coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of two numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.centerline_smooth">
<code class="descname">centerline_smooth</code><a class="headerlink" href="#rivgraph.classes.river.centerline_smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>A smooth version of centerline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>shapely.geometry.LineString</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.max_valley_width_pixels">
<code class="descname">max_valley_width_pixels</code><a class="headerlink" href="#rivgraph.classes.river.max_valley_width_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum valley width in pixels, defined by widths along the centerline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.width_chans">
<code class="descname">width_chans</code><a class="headerlink" href="#rivgraph.classes.river.width_chans" title="Permalink to this definition">¶</a></dt>
<dd><p>Average channel width</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.width_extent">
<code class="descname">width_extent</code><a class="headerlink" href="#rivgraph.classes.river.width_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Average width of the holes-filled channel mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.meshlines">
<code class="descname">meshlines</code><a class="headerlink" href="#rivgraph.classes.river.meshlines" title="Permalink to this definition">¶</a></dt>
<dd><p>The lines of the mesh that are perpendicular to the local river direction</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of shapely.geometry.LineString</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.meshpolys">
<code class="descname">meshpolys</code><a class="headerlink" href="#rivgraph.classes.river.meshpolys" title="Permalink to this definition">¶</a></dt>
<dd><p>Polygons comprising the along-channel mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of shapely.geometry.Polygon</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.skeletonize">
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.skeletonize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.skeletonize" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes the river binary mask; uses a different method than for deltas.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.prune_network">
<code class="descname">prune_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.prune_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.prune_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Prunes the river channel network by removing spurs.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.compute_centerline">
<code class="descname">compute_centerline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_centerline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.compute_centerline" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the centerline of the holes-filled river channel network mask.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.compute_mesh">
<code class="descname">compute_mesh</code><span class="sig-paren">(</span><em>grid_spacing=None</em>, <em>smoothing=0.1</em>, <em>bufferdist=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.compute_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a mesh that follows the channel centerline; grid_spacing sets the length of each grid cell; bufferdist sets the width of each grid cell.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.assign_flow_direcions">
<code class="descname">assign_flow_direcions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rivgraph.classes.river.assign_flow_direcions" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes flow directions for each link in the delta channel network.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.set_flow_dirs_manually">
<code class="descname">set_flow_dirs_manually</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rivgraph.classes.river.set_flow_dirs_manually" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a user-created .csv file found at paths[‘fixlinks_csv’] to set flow directions of specified liks.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a channelnetwork class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the channel network; also defines the folder name for storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>exit_sides</strong> (<em>str</em>) – Only required for river channel netowrks. A two-character string (from N, E, S, or W) that denotes which sides of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’, ‘NW’, etc.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="rivgraph.classes.river.name">
<code class="descname">name</code><a class="headerlink" href="#rivgraph.classes.river.name" title="Permalink to this definition">¶</a></dt>
<dd><p>the name of the channel network, usually the river or delta’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.verbose">
<code class="descname">verbose</code><a class="headerlink" href="#rivgraph.classes.river.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>[True] or False to specify if processing updates should be printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.d">
<code class="descname">d</code><a class="headerlink" href="#rivgraph.classes.river.d" title="Permalink to this definition">¶</a></dt>
<dd><p>object created by gdal.Open() that provides access to geotiff metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>osgeo.gdal.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.mask_path">
<code class="descname">mask_path</code><a class="headerlink" href="#rivgraph.classes.river.mask_path" title="Permalink to this definition">¶</a></dt>
<dd><p>filepath to the input binary channel network mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.imshape">
<code class="descname">imshape</code><a class="headerlink" href="#rivgraph.classes.river.imshape" title="Permalink to this definition">¶</a></dt>
<dd><p>dimensions of the image (rows, cols)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.gt">
<code class="descname">gt</code><a class="headerlink" href="#rivgraph.classes.river.gt" title="Permalink to this definition">¶</a></dt>
<dd><p>gdal-type Geotransform of the input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.wkt">
<code class="descname">wkt</code><a class="headerlink" href="#rivgraph.classes.river.wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>well known text representation of coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.epsg">
<code class="descname">epsg</code><a class="headerlink" href="#rivgraph.classes.river.epsg" title="Permalink to this definition">¶</a></dt>
<dd><p>epsg code of the coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.unit">
<code class="descname">unit</code><a class="headerlink" href="#rivgraph.classes.river.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>units of the coordinate reference system; typically ‘degree’ or ‘meter’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.pixarea">
<code class="descname">pixarea</code><a class="headerlink" href="#rivgraph.classes.river.pixarea" title="Permalink to this definition">¶</a></dt>
<dd><p>area of each pixel, in units of ‘unit’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.pixlen">
<code class="descname">pixlen</code><a class="headerlink" href="#rivgraph.classes.river.pixlen" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each pixel, assumes sides are equal-length</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.paths">
<code class="descname">paths</code><a class="headerlink" href="#rivgraph.classes.river.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary of strings for managing where files should be read/written</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.exit_sides">
<code class="descname">exit_sides</code><a class="headerlink" href="#rivgraph.classes.river.exit_sides" title="Permalink to this definition">¶</a></dt>
<dd><p>two-character string denoting which sides of the image the channel network intersects (N,E,S, and/or W). Upstream side should be given first.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.Imask">
<code class="descname">Imask</code><a class="headerlink" href="#rivgraph.classes.river.Imask" title="Permalink to this definition">¶</a></dt>
<dd><p>binary mask found at mask_path loaded into a numpy array via gdal.Open().ReadAsArray(), dtype=np.bool</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.links">
<code class="descname">links</code><a class="headerlink" href="#rivgraph.classes.river.links" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the links of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#rivgraph.classes.river.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the nodes of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.river.Idist">
<code class="descname">Idist</code><a class="headerlink" href="#rivgraph.classes.river.Idist" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the distance transform of the binary mask, dtype=np.float</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.river.assign_flow_directions">
<code class="descname">assign_flow_directions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.assign_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.river.assign_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically sets flow directions for each link in a braided river
channel network.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_centerline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_centerline"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Computes the centerline of the holes-filled river binary image.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">compute_mesh</code><span class="sig-paren">(</span><em>grid_spacing=None</em>, <em>smoothing=0.1</em>, <em>buf_halfwidth=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.compute_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Generates an along-centerline mesh that indicates a valley-direction
of sorts. The mesh is useful for computing spatial statistics as a function
of downstream distance. The resulting mesh captures the low-frequency
characteristic of the river corridor.</p>
<p>This tool is tricky to fully automate, and the user may need to play
with the smoothing and bufferdist parameters if errors are thrown or
the result is not satisfying.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_spacing</strong> (<em>float</em>) – Defines the distance between perpendicular-to-centerline transects.
Units are defined by input mask CRS.</p></li>
<li><p><strong>smoothing</strong> (<em>float</em>) – Defines the smoothing window of the left- and right-valleylines as a fraction
of the total centerline length. Range is [0, 1].</p></li>
<li><p><strong>buf_halfwidth</strong> (<em>float</em>) – Defines the offset distance of the left- and right-valleylines from
from the centerline. Units correspond to those of the CRS of the
input mask.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">prune_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.prune_network"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Prunes the computed river network.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">skeletonize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#river.skeletonize"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Skeletonizes the river binary mask.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rivgraph.classes.rivnetwork">
<em class="property">class </em><code class="descclassname">rivgraph.classes.</code><code class="descname">rivnetwork</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>The rivnetwork class organizes data and methods for channel networks. This is
a parent class to the delta and river classes which inherit rivnetwork methods and
attributes. This class thus represents the common elements of river and delta
channel networks.</p>
<dl class="method">
<dt id="rivgraph.classes.rivnetwork.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>name</em>, <em>path_to_mask</em>, <em>results_folder=None</em>, <em>exit_sides=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a channelnetwork class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – The name of the channel network; also defines the folder name for storing results.</p></li>
<li><p><strong>path_to_mask</strong> (<em>str</em>) – Points to the channel network mask file path</p></li>
<li><p><strong>results_folder</strong> (<em>str</em>) – Specifies a directory where results should be stored</p></li>
<li><p><strong>exit_sides</strong> (<em>str</em>) – Only required for river channel netowrks. A two-character string (from N, E, S, or W) that denotes which sides of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’, ‘NW’, etc.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.name">
<code class="descname">name</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.name" title="Permalink to this definition">¶</a></dt>
<dd><p>the name of the channel network, usually the river or delta’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.verbose">
<code class="descname">verbose</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>[True] or False to specify if processing updates should be printed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.d">
<code class="descname">d</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.d" title="Permalink to this definition">¶</a></dt>
<dd><p>object created by gdal.Open() that provides access to geotiff metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>osgeo.gdal.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.mask_path">
<code class="descname">mask_path</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.mask_path" title="Permalink to this definition">¶</a></dt>
<dd><p>filepath to the input binary channel network mask</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.imshape">
<code class="descname">imshape</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.imshape" title="Permalink to this definition">¶</a></dt>
<dd><p>dimensions of the image (rows, cols)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.gt">
<code class="descname">gt</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.gt" title="Permalink to this definition">¶</a></dt>
<dd><p>gdal-type Geotransform of the input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.wkt">
<code class="descname">wkt</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>well known text representation of coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.epsg">
<code class="descname">epsg</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.epsg" title="Permalink to this definition">¶</a></dt>
<dd><p>epsg code of the coordinate reference system of input mask geotiff</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.unit">
<code class="descname">unit</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>units of the coordinate reference system; typically ‘degree’ or ‘meter’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.pixarea">
<code class="descname">pixarea</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.pixarea" title="Permalink to this definition">¶</a></dt>
<dd><p>area of each pixel, in units of ‘unit’</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.pixlen">
<code class="descname">pixlen</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.pixlen" title="Permalink to this definition">¶</a></dt>
<dd><p>length of each pixel, assumes sides are equal-length</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.paths">
<code class="descname">paths</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.paths" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary of strings for managing where files should be read/written</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.exit_sides">
<code class="descname">exit_sides</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.exit_sides" title="Permalink to this definition">¶</a></dt>
<dd><p>two-character string denoting which sides of the image the channel network intersects (N,E,S, and/or W). Upstream side should be given first.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.Imask">
<code class="descname">Imask</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.Imask" title="Permalink to this definition">¶</a></dt>
<dd><p>binary mask found at mask_path loaded into a numpy array via gdal.Open().ReadAsArray(), dtype=np.bool</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.links">
<code class="descname">links</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.links" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the links of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the nodes of the network and associated properties</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.Idist">
<code class="descname">Idist</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.Idist" title="Permalink to this definition">¶</a></dt>
<dd><p>image of the distance transform of the binary mask, dtype=np.float</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="rivgraph.classes.rivnetwork.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#rivgraph.classes.rivnetwork.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.adjacency_matrix">
<code class="descname">adjacency_matrix</code><span class="sig-paren">(</span><em>weight=None</em>, <em>normalized=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.adjacency_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.adjacency_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the adjacency matrix for a graph defined by links and nodes
dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight</strong> (<em>str</em><em>, </em><em>optional</em>) – [None] or the attribute in the links dictionary to use for weighting links. Typically ‘wid_adj’ or ‘len’.</p></li>
<li><p><strong>normalized</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, each row in the adjacency matrix will sum to one. [False] by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>A</strong> – an NxN matrix representing the connectivity of the graph, where N is the
number of nodes in the network. See adjacency matrix for more details.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_distance_transform">
<code class="descname">compute_distance_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_distance_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_distance_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the distance transform of the channel network mask.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_junction_angles">
<code class="descname">compute_junction_angles</code><span class="sig-paren">(</span><em>weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_junction_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_junction_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the angle at nodes where only three links are connected. Directions
must be assigned before angles can be computed. Also defines each 3-link
node as ‘confluence’ or ‘bifurcation’ and appends this designation to
the nodes dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weight</strong> (<em>str</em>) – [None], ‘exp’ (exponential), or ‘lin’ (linear) to determine the decay
of the weights the contributions of pixels as we move away from the
junction node.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_link_width_and_length">
<code class="descname">compute_link_width_and_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_link_width_and_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_link_width_and_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes widths and lengths of each link in the links dictionary and
appends them as dictionary attributes.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.compute_network">
<code class="descname">compute_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.compute_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.compute_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the links and nodes of the channel network mask.  First skeletonizes
the mask if not already done, then resolves the skeleton’s graph.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.get_islands">
<code class="descname">get_islands</code><span class="sig-paren">(</span><em>props=['area', 'maxwidth', 'major_axis_length', 'minor_axis_length', 'surrounding_links']</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.get_islands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.get_islands" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the islands in the binary mask and computes their morphological
properties. Can be used to help “clean” masks of small islands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>props</strong> (<em>list</em><em>, </em><em>optional</em>) – Properties to compute for each island. Properties can be any of those
provided by rivgraph.im_utils.regionprops.
The default is [‘area’, ‘maxwidth’, ‘major_axis_length’, ‘minor_axis_length’].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>islands</strong> – Contains the polygons of each island with the requested property
attributes as columns. An additional ‘remove’ attribute is
initialized to make thresholding easier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geopandas GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.load_network">
<code class="descname">load_network</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.load_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.load_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the link and nodes dictionaries from a .pkl file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path–including extension–to network .pkl file. If [None], file
is loaded from path found in paths[‘network_pickle’]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*kwargs</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates matplotlib plots of the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*kwargs</strong> (<em>str</em>) – If [None], both of the following plots will be generated:
‘network’: links and nodes are plotted, labeled with their ids
‘directions’: links are plotted with their directionality indicated</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.save_network">
<code class="descname">save_network</code><span class="sig-paren">(</span><em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.save_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.save_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the link and nodes dictionaries to a .pkl file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – path–including extension–to network .pkl file. If [None], file
written to path found in paths[‘network_pickle’]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.to_geotiff">
<code class="descname">to_geotiff</code><span class="sig-paren">(</span><em>export</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.to_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.to_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes geotiffs to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>export</strong> (<em>str</em>) – <dl class="simple">
<dt>Select a raster to write to geotiff. Choose from:</dt><dd><p>’directions’ - network burned into a raster with link directions from 0 (upstream) to 1 (downstream))
‘skeleton’  - skeletonized mask
‘distance’ - distance-transformed mask</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="rivgraph.classes.rivnetwork.to_geovectors">
<code class="descname">to_geovectors</code><span class="sig-paren">(</span><em>export='network'</em>, <em>ftype='json'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/classes.html#rivnetwork.to_geovectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.classes.rivnetwork.to_geovectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the links and nodes of the network to geovectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>export</strong> (<em>str</em>) – <dl class="simple">
<dt>Determines which features to export. Choose from:</dt><dd><p>all (exports all available vector data)
network (links and nodes)
links
nodes
centerline (river classes only)
mesh (centerline mesh, river classes only)
centerline_smooth (river classes only)</p>
</dd>
</dl>
</p></li>
<li><p><strong>ftype</strong> (<em>str</em>) – <dl class="simple">
<dt>Sets the output file format. Choose from:</dt><dd><p>json (GeoJSON)
shp  (ESRI Shapefile)</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-rivgraph.directionality"></span><div class="section" id="directionality">
<h2>directionality<a class="headerlink" href="#directionality" title="Permalink to this headline">¶</a></h2>
<p>Created on Wed Nov  7 11:38:16 2018
&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.directionality.add_directionality_trackers">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">add_directionality_trackers</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>ntype</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#add_directionality_trackers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.add_directionality_trackers" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds fields to the links and nodes dictionaries that are required for
setting and diagnosing directionality. Nodes are not altered in this
function, but passed for consistency and generalizability.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param ntype: Network type. Choose either ‘delta’ or ‘river’.
:type ntype: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links with added directionality properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.algmap">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">algmap</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#algmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.algmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a numeric key corresponding to each algorithm used by RivGraph to
set link directionality. These numbers are found in links[‘guess_alg’] and
links[‘certain_alg’] and are useful for diagnosing issues in setting
directionality.
:param key: See the mapper below for the possible keywords.
:type key: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>algno</strong> – Numeric representation of direction-setting algorithm.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float or int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.check_continuity">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">check_continuity</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#check_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.check_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all sinks or sources within the network, excluding inlets and outlets.
Returns any nodes where continuity is violated. Only checks nodes for whom
all attached links are certain.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>problem_nodes</strong> – Node ids corresponding to nodes[‘id’] where continuity is violated.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.cycle_get_original_orientation">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">cycle_get_original_orientation</code><span class="sig-paren">(</span><em>links</em>, <em>lids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#cycle_get_original_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.cycle_get_original_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the orientation of a set of links. Used before attempting to fix
cycles. Properties besides ‘conn’ must also be reversed, so their original
orientations are also stored.
:param links: Network links and associated properties.
:type links: dict
:param lids: Link ids whose orientations should be saved.
:type lids: list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>orig</strong> – A subset of the links dictionary containing the orientations of each
link in lids.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.cycle_return_to_original_orientation">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">cycle_return_to_original_orientation</code><span class="sig-paren">(</span><em>links</em>, <em>orig</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#cycle_return_to_original_orientation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.cycle_return_to_original_orientation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of links to its original orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>orig</strong> (<em>dict</em>) – Network links and associated properties to return to original
orientations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>links</strong> – Network links and associated properties in their original orientations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_bridges">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_bridges</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_bridges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_bridges" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality of bridge links. Bridge links are those which flow
must pass through to reach the outlet; in other words, if a bridge link is
removed from the network, there will no longer be just one connected
network. Directionality is inferred by consideration of which subnetwork
(after removing the bridge link) contains inlet and outlet nodes.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_known_link_angles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_known_link_angles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>dims</em>, <em>checklinks='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_known_link_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_known_link_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality for unknown links whose immediately adjacent links’
directionalities are known. Computes the angle of “flow” between outlet and
inlet end nodes for each neighboring link, then sets the unknown link
such that its orientation minimizes the error between its neighbors and
itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – Shape of the input mask as (nrows, ncols).</p></li>
<li><p><strong>checklinks</strong> (<em>list OR str</em><em>, </em><em>optional</em>) – A list of link ids can be provided to check only specific links.
Otherwise, the default is ‘all’ which checks all links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_main_channel">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_main_channel</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_main_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_main_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses directionality of links based on shortest paths from widest inlet
link to all the outlet links. Links are also weighted by width, such that
deviations from the “main channel” width cost more to traverse.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_set_manually">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_set_manually</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>manual_set_csv</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_set_manually"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_set_manually" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets link directions based on a user-provided csv-file. The csv file has
exactly two columns; one called ‘link_id’, and one called ‘usnode’.
This file can be created automatically by the function
io_utils.create_manual_dir_csv().
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param manual_set_csv: Path to csv defining which links have which upstream nodes.
:type manual_set_csv: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with specified links set
manually.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with specified links set
manually.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_shortest_paths_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_shortest_paths_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>difthresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_shortest_paths_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_shortest_paths_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses a link’s directionality by which of its endpoint nodes is
closer to the nearest outlet (or preoutlet). “difthresh” refers to the
difference in distances between endpoint nodes; higher means directionality
is less likely to be ascertained.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param difthresh: Threshold for the length (in number of nodes) that must be surpassed</p>
<blockquote>
<div><p>between an unknown link’s endpoints for directionality to be set.
Lengths are measured from the link’s endpoints to the nearest
outlet (or preoutlet). The default is 0.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.dir_shortest_paths_nodes">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">dir_shortest_paths_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#dir_shortest_paths_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.dir_shortest_paths_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Guesses link directionality based on the shortest path from its end
nodes to the nearest outlet (or pre-outlet). For each unknown link, if the
path flows through the link attached to the node (as opposed to immediately)
away from the link), its directionality is set; otherwise nothing
is done. Note that this will not set all links’ directionalities.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.find_a_cycle">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">find_a_cycle</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#find_a_cycle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.find_a_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a single cycle in the network. Multiple cycles may exist; this
function returns only the first one encountered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cycle_nodes</strong> (<em>list</em>) – Node ids comprising the cycle. Arranged in order of cycle.</p></li>
<li><p><strong>cycle_links</strong> (<em>list</em>) – Link ids comprising the cycle. Arranged in order of cycle.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.fix_cycles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">fix_cycles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#fix_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.fix_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to remove all cycles in the directed graph. A number of approaches
are tried, and if any of them result in a source/sink node or a cycle,
another approach is attempted until the cycle is resolved or we run out
of approaches.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with all possible cycles
resolved.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with all possible cycles
resolved</p></li>
<li><p><strong>n_cycles_remaining</strong> (<em>int</em>) – Number of cycles that were unresolvable.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.fix_sources_and_sinks">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">fix_sources_and_sinks</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#fix_sources_and_sinks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.fix_sources_and_sinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes sources and sinks within the network by flipping link directionality
near the problem node(s). The links to flip are chosen by ensuring they do
not create a cycle; if multiple links can be flipped, the shortest one is
chosen. If no solution is found, links are returned to their original
orientation.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with sources/sinks fixed if
possible.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network links and associated properties with sources/sinks fixed if
possible.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.flip_links_in_G">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">flip_links_in_G</code><span class="sig-paren">(</span><em>G</em>, <em>links2flip</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#flip_links_in_G"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.flip_links_in_G" title="Permalink to this definition">¶</a></dt>
<dd><p>Flips the directionality of links in a networkx graph object.
:param G: Graph object representing the network.
:type G: networkx.Graph or similar
:param links2flip: An Nx2 tuple containing the US and DS node ids of the edge (link) to</p>
<blockquote>
<div><p>flip.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>G</strong> – Graph object representing the network with the requested links flipped.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>networkx.Graph or similar</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.get_cycles">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">get_cycles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknode='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#get_cycles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.get_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds either all cycles in the network or cycles containing the checknode’th
node. Cycles are returned as both nodes and links.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param checknode: ID of node to check for its inclusion in any cycles. If the default</p>
<blockquote>
<div><p>value ‘all’ is selected, all cycles will be returned.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>cycle_nodes</strong> (<em>list of lists</em>) – List containing lists of all cycles found in the network; cycles are
returned in cyclic order and in terms of node ids.</p></li>
<li><p><strong>cycles_links</strong> (<em>TYPE</em>) – List containing lists of all cycles found in the network; cycles are
returned in cyclic order and in terms of link ids.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.get_link_vector">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">get_link_vector</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>linkid</em>, <em>imshape</em>, <em>pixlen=1</em>, <em>normalized=True</em>, <em>trim=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#get_link_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.get_link_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the normalized vector of a link that indicates the direction of
flow through a link based on its connectivity. This function will first trim
the link by its endpoint (half)width values to mitigate cases where where wide
channels are connected to narrow channels.</p>
<p>Requires a link contain at least min_len_for_trim pixels post-trimming.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param linkid: ID of the link correspoinding to those found in links[‘id’].
:type linkid: int
:param imshape: Shape of the binary mask as (nrows, ncols).
:type imshape: tuple
:param pixlen: Length resolution of each pixel. The default is 1.
:type pixlen: float, optional
:param normalized: If True, will return a vector on [-1, 1]. The default is True.
:type normalized: bool, optional
:param trim: If True, links will be trimmed to remove possibly direction-biasing</p>
<blockquote>
<div><p>end segments. If False, the untrimmed link endpoints will define the
vector direction. The default is False.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>link_vec</strong> – Two-element array describing the x and y components of the direction
vector describing the link.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.merge_list_of_lists">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">merge_list_of_lists</code><span class="sig-paren">(</span><em>inlist</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#merge_list_of_lists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.merge_list_of_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges a list of lists into a single list, but removes duplicates.
Uses networkx and itertools for a fun solution.
:param inlist: List of lists to merge without dulplicates.
:type inlist: list of lists</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>merged</strong> – List of length equal to number of unique entries across all lists of
inlist.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.nodepath_to_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">nodepath_to_links</code><span class="sig-paren">(</span><em>path</em>, <em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#nodepath_to_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.nodepath_to_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a path defined by node ids to a path defined by link ids.
:param path: Node ids comprising a path within the network.
:type path: list
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>linkpath</strong> – Link ids comprising the path defined by the given node ids.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_artificial_nodes">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_artificial_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknodes='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_artificial_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_artificial_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is deprecated as of v0.3 and is no longer called.</p>
<p>Set the directionality of links where aritificial nodes were added. For such
loops, flow will travel the same way through both sides of the loop (to avoid
cycles). Therefore, if one side is known, we can set the other side.
Method 1 sets a broken link if its counterpart is known.
Method 2 sets a side of the loop if the other side is known.
Method 3 sets both sides if the input to one of the end nodes is known.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param checknodes: Node ids to check for presence of settable artificial links. If ‘all’,</p>
<blockquote>
<div><p>all nodes in the network are checked.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_by_known_flow_directions">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_by_known_flow_directions</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>angthresh=2</em>, <em>lenthresh=0</em>, <em>nknown_thresh=1</em>, <em>alg=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_by_known_flow_directions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_by_known_flow_directions" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets unknown link directions by determining which flow direction through
the link minimizes the overall change in flow direction at the connecting
nodes. For a set of links connected to a node, at least one of the links’
directions must be known for this algorithm to be effective. Links are
set from longest to shortest, as longer links generally have less
uncertainty associated with their directions.</p>
<p>A number of thresholds are provided as options to control the power of
the algorithm. This function should generally be applied iteratively,
beginning with the most restrictive thresholds and gradually relaxing
them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of the binary mask as (nrows, ncols).</p></li>
<li><p><strong>angthresh</strong> (<em>float</em><em>, </em><em>optional</em>) – Angle in radians to determine if an unknown link is parallel enough to
its connected known links to set its direction. The default is 2.</p></li>
<li><p><strong>lenthresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Length in pixels of the minimum link length required to use this
algorithm to set its directionality. The default is 0.</p></li>
<li><p><strong>nknown_thresh</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of known connected links required to use this algorithm to
set the unknown link’s directionality. The default is 1.</p></li>
<li><p><strong>alg</strong> (<em>float</em><em>, </em><em>optional</em>) – Algorithm ID to assign to the set link. The default is 6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_by_nearest_main_channel">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_by_nearest_main_channel</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>nodethresh=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_by_nearest_main_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_by_nearest_main_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets all possible links’ directions using the nearest main channel. The
main channels are found as the widest, shortest paths from each inlet to
each outlet. For each unknown link, the distance is computed from its
endpoints to the nearest nodes of the nearest main channel. If the nearest
nodes of the main channel include more than 2 + nodethresh nodes, the
direction of the main channel is used to set the unknown link.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param imshape: Shape of binary mask as (nrows, ncols).
:type imshape: tuple
:param nodethresh: Threshold for the number of nodes along the nearest main channel that</p>
<blockquote>
<div><p>must be encompassed by the unknown link’s endnodes to confidently
set the unknown link’s direction. The default is 0.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_continuity">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_continuity</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>checknodes='all'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_continuity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_continuity" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets link directions by enforce continuity at each node such that there
are no sources or sinks within the network. Iterates until no more links
directions can be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>checknodes</strong> (<em>list OR str</em><em>, </em><em>optional</em>) – Each link connected to each node id in this list will be checked for
continuity. All nodes will be checked if using the default value ‘all’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_inletoutlet">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_inletoutlet</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_inletoutlet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_inletoutlet" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets directions of links that are connected to inlets and outlets.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_link">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_link</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>linkidx</em>, <em>usnode</em>, <em>alg=9999</em>, <em>checkcontinuity=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a link directionality. Option to check for continuity (including
parallel links) after setting.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict
:param linkidx: Index of link within links[‘id’] to set. This index can be found from</p>
<blockquote>
<div><p>the link id via links[‘id’].index(linkid).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>usnode</strong> (<em>int</em>) – Node id of the upstream node.</p></li>
<li><p><strong>alg</strong> (<em>int</em><em>, </em><em>optional</em>) – The algorithm id used to set the link. Used for diagnostic purposes and
fixing cycles. The default is 9999.</p></li>
<li><p><strong>checkcontinuity</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, checks nearby links for continuity and parallel links after
setting the link’s direction. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with updated link direction.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with updated link direction.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.set_parallel_links">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">set_parallel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>knownlink</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#set_parallel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.set_parallel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets directionality of parallel links. If two links are parallel, they
share the same end nodes. If the direction of one of the links is known,
the other must be set in a direction to avoide creating a cycle within
the graph. This function thus prevents cycles from being created and in
general should be run after any link direction is set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>knownlink</strong> (<em>int</em>) – Link id of link whose direction has been set to check for parallel
links.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties updated to set directionality
according to this algorithm.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties updated to set directionality
according to this algorithm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.directionality.widest_inlet_index">
<code class="descclassname">rivgraph.directionality.</code><code class="descname">widest_inlet_index</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/directionality.html#widest_inlet_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.directionality.widest_inlet_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the index of the inlet occurring at the widest link. Index is with
respect to the nodes[‘id’] list.
:param links: Network links and associated properties.
:type links: dict
:param nodes: Network nodes and associated properties.
:type nodes: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>inlet_idx</strong> – Index of the inlet node of the widest link.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.geo_utils"></span><p>Utilities for reading, writing, managing, processing, manipulating, etc.
geographic data including tiffs, vrts, shapefiles, etc.</p>
<p>6/2/2020 - Consider merging this into io_utils and im_utils. Not much actual
functionality here, and some of these functions are simply unused.</p>
<dl class="function">
<dt id="rivgraph.geo_utils.coords_to_xy">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">coords_to_xy</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>gt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#coords_to_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.coords_to_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of xs, ys in projected coordinates to rows, columns within
a geotiff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>list</em><em> or </em><em>np.array</em><em>(</em><em>)</em>) – Specifies the E-W coordinates (longitude).</p></li>
<li><p><strong>ys</strong> (<em>list</em><em> or </em><em>np.array</em><em>(</em><em>)</em>) – Specifies the N-S coordinates (latitude).</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – 6-element tuple gdal GeoTransform. (uL_x, x_res, rotation, ul_y, rotation, y_res).
Automatically created by gdal’s GetGeoTransform() method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rowcols</strong> – Nx2 array of (row, col) indices corresponding to the inpute coordinates. N = len(xs).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.crop_geotif">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">crop_geotif</code><span class="sig-paren">(</span><em>tif</em>, <em>cropto='first_nonzero'</em>, <em>npad=0</em>, <em>outpath=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#crop_geotif"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.crop_geotif" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a geotiff to the minimum bounding box as defined by the first
nonzero pixels along each direction. The cropped image is written to
disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tif</strong> (<em>str</em>) – Path to geotiff to crop.</p></li>
<li><p><strong>cropto</strong> (<em>str</em>) – [first_nonzero] is currently the only choice.</p></li>
<li><p><strong>npad</strong> (<em>int</em>) – Number of pixels to add to each direction of the cropped image.</p></li>
<li><p><strong>outpath</strong> (<em>str</em>) – Defines the path where the cropped image will be written to disk. If
[None], the file will be written to the same directory as the input
geotiff.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_file</strong> – Path to the saved, cropped geotiff.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.geotiff_vals_from_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">geotiff_vals_from_coords</code><span class="sig-paren">(</span><em>coords</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#geotiff_vals_from_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.geotiff_vals_from_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns pixel values at specific coordinates from a geotiff object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.array</em><em>(</em><em>)</em>) – An Nx2 numpy array, where each row is a (lat, lon) pair.</p></li>
<li><p><strong>gd_obj</strong> (<em>osgeo.gdal.Dataset</em>) – Geotiff object created with gdal.Open().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vals</strong> – The value of the pixels of the geotiff for each coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.get_unit">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">get_unit</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#get_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.get_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the units for a projection defined by an EPSG code.
See <a class="reference external" href="https://en.wikibooks.org/wiki/PROJ.4#Units">https://en.wikibooks.org/wiki/PROJ.4#Units</a> for a list of unit string
maps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>crs</strong> (<em>pyproj CRS object</em>) – Defines the coordinate reference system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>unit</strong> – The unit of the provided epsg code.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.idx_to_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">idx_to_coords</code><span class="sig-paren">(</span><em>idx</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#idx_to_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.idx_to_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of indices from a geotiff image to their corresponding
coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.array</em><em>(</em><em>)</em>) – Specifies the indices to transform. See np.ravel_index for more info.</p></li>
<li><p><strong>gd_obj</strong> (<em>osego.gdal.Dataset</em>) – gdal object of the geotiff from which indices were computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cx, cy</strong> – x and y coordinates of the provided indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.transform_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">transform_coords</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>inputEPSG</em>, <em>outputEPSG</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#transform_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.transform_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of coordinates from one epsg to another.
This implementation differs from above by using pyproj.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ys</strong><strong>)</strong> (<em>(</em><em>xs</em><em>,</em>) – Specifies the coordinates to transform.</p></li>
<li><p><strong>inputEPSG</strong> (<em>int</em>) – epsg code corresponding to xs, ys</p></li>
<li><p><strong>outputEPSG</strong> (<em>int</em>) – epsg code corresponding to desired CRS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xy</strong> – Two element array of transformed (x, y) coordinates. xy[0] are
transformed x coordinates, xy[1] are transformed y coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.geo_utils.xy_to_coords">
<code class="descclassname">rivgraph.geo_utils.</code><code class="descname">xy_to_coords</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>gt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/geo_utils.html#xy_to_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.geo_utils.xy_to_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a set of x and y coordinates to their corresponding coordinates
within a geotiff image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ys</strong><strong>)</strong> (<em>(</em><em>xs</em><em>,</em>) – Specifies the coordinates to transform.</p></li>
<li><p><strong>gt</strong> (<em>tuple</em>) – 6-element tuple gdal GeoTransform. (uL_x, x_res, rotation, ul_y, rotation, y_res).
Automatically created by gdal’s GetGeoTransform() method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cx, cy</strong> – Column and row indices of the provided coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-rivgraph.im_utils"></span><div class="section" id="im-utils">
<h2>im_utils<a class="headerlink" href="#im-utils" title="Permalink to this headline">¶</a></h2>
<p>Almost all the functions that manipulate images within this file require that
the images be binary.</p>
<p>Many of these functions are wrappers around functionality found in skimage or
opencv that either add additonal functionality or provide convenience.</p>
<dl class="function">
<dt id="rivgraph.im_utils.blob_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">blob_idcs</code><span class="sig-paren">(</span><em>I</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#blob_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.blob_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the indices for each blob within I.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image containing blobs.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcs</strong> – An n-element list of sets, where n is the number of blobs in I, and
each set contains the pixel indices within I of a blob.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.bp_kernels">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">bp_kernels</code><span class="sig-paren">(</span><em>caseno</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#bp_kernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.bp_kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides kernels for convolving with branchpoints image to remove special
cases (where three branchpoints make an “L” shape). There are 8 possible
orientations (caseno’s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>caseno</strong> (<em>int</em>) – Identifier for specific kernel cases. Can be 1-8.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kernel</strong> – 3x3 kernel corresponding to the caseno.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.crop_binary_coords">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">crop_binary_coords</code><span class="sig-paren">(</span><em>coords</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#crop_binary_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.crop_binary_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops an array of (row, col) coordinates (e.g. blob indices) to the smallest
possible array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>np.array</em>) – N x 2 array. First column are rows, second are columns of pixel coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Image of the cropped coordinates, plus padding if desired.</p></li>
<li><p><strong>clipped</strong> (<em>list</em>) – Number of pixels in [left, top, right, bottom] direction that were
clipped.  Clipped returns the indices within the original coords image
that define where I should be positioned within the original image.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.crop_binary_im">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">crop_binary_im</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#crop_binary_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.crop_binary_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Crops a binary image to the smallest bounding box containing all the “on”
pixels in the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image to crop.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Icrop</strong> (<em>np.array</em>) – The cropped binary image.</p></li>
<li><p><strong>pads</strong> (<em>list</em>) – Four element list containing the number of pixels that were cropped
from the [left, top, right, bottom] of I.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.dilate">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">dilate</code><span class="sig-paren">(</span><em>I</em>, <em>n=1</em>, <em>strel='square'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#dilate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.dilate" title="Permalink to this definition">¶</a></dt>
<dd><p>Dilates a binary image using a specified kernel shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to dilate.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times to apply the dilating kernel. The default is 1.</p></li>
<li><p><strong>strel</strong> (<em>str</em><em>, </em><em>optional</em>) – Kernel shape. Follows skimage’s options, but only ‘square’, ‘plus’, and
‘disk’ are supported. The default is ‘square’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Id</strong> – Dilated binary image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.downsample_binary_image">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">downsample_binary_image</code><span class="sig-paren">(</span><em>I</em>, <em>newsize</em>, <em>thresh=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#downsample_binary_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.downsample_binary_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an input binary image and a new size, this downsamples (i.e. reduces
resolution) the input image to the new size. A pixel is considered “on”
in the new image if ‘thresh’ fraction of its area is covered by the
higher-res image. E.g. set ‘thresh’ to zero if you want the output image
to be “on” everywhere at least a single pixel is “on” in the original
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to downsample.</p></li>
<li><p><strong>newsize</strong> (<em>tuple</em>) – Two entry tuple (nrows, ncols) specifying the desired shape of the
image.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em>, </em><em>optional</em>) – The fraction of filled area that downsampled pixels must have to
consider them on. Setting to 0 is the equialent of “all touched”.
The default is 0.05.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iout</strong> – The downsampled image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.edge_coords">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">edge_coords</code><span class="sig-paren">(</span><em>sizeI</em>, <em>dtype='flat'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#edge_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.edge_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an image size, returns the coordinates of all the edge pixels (4 edges).
Can return as indices (dtype=flat) or x,y coordinates (dtype=’xy’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sizeI</strong> (<em>tuple</em>) – Shape of the image.</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘flat’, returns output as indices within I. If ‘xy’, returns (col, row)
of edge pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>edgepts</strong> – Coordinates of the edge pixels. If dtype==’flat’, returns a set. If
dtype==’xy’, returns a list of [columns, rows].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set or list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.erode">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">erode</code><span class="sig-paren">(</span><em>I</em>, <em>n=1</em>, <em>strel='square'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#erode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.erode" title="Permalink to this definition">¶</a></dt>
<dd><p>Erodes a binary image using a specified kernel shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to erode.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of times to apply the eroding kernel. The default is 1.</p></li>
<li><p><strong>strel</strong> (<em>str</em><em>, </em><em>optional</em>) – Kernel shape. Follows skimage’s options, but only ‘square’, ‘plus’, and
‘disk’ are supported. The default is ‘square’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ie</strong> – Eroded binary image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.fill_holes">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">fill_holes</code><span class="sig-paren">(</span><em>I</em>, <em>maxholesize=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#fill_holes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills holes up to a specified size in a binary image. The boundary pixels
of the image are turned off before identifying holes so that holes created
by the edge of the image are not considered holes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p></li>
<li><p><strong>maxholesize</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum allowed hole size in pixels. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – The holes-filled image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.four_conn">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">four_conn</code><span class="sig-paren">(</span><em>idcs</em>, <em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#four_conn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.four_conn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of 4-connected neighbors for a given flat index in I.
idcs must be a list, even if a single value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idcs</strong> (<em>list</em>) – Indices within I to find 4-connected neighbors.</p></li>
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourconn</strong> – Number of four-connected neighbors for each index in idcs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.get_array">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">get_array</code><span class="sig-paren">(</span><em>idx</em>, <em>I</em>, <em>size</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#get_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.get_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sub-image of an input image, centered at a specified index within
the input image and a specified size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index within I on which to center the returned array. Can also be a
[row, col] list.</p></li>
<li><p><strong>I</strong> (<em>np.array</em>) – Image to pull from.</p></li>
<li><p><strong>size</strong> (<em>list</em>) – Two-entry list specifying the number of [rows, cols] to return from
I centered at idx.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>subimage</strong> (<em>np.array</em>) – The sub-image of I, centered at idx with shape specified by size.</p></li>
<li><p><strong>row</strong> (<em>int</em>) – The first row within I that the sub-image is drawn from.</p></li>
<li><p><strong>col</strong> (<em>int</em>) – The first column within I that the sub-image is drawn from.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.hand_clean">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">hand_clean</code><span class="sig-paren">(</span><em>I</em>, <em>action='erase'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#hand_clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.hand_clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows user to hand-draw regions of interest on a binary mask that can
either be filled (set to True) or erased (set to False). Only one polygon
can be drawn per call.</p>
<dl class="simple">
<dt>Interact with plot via the following:</dt><dd><p>left-click: save a vertex of the polygon
right-click: remove the last point (useful when zooming/panning)
enter key: stop recording points</p>
</dd>
</dl>
<p>Possible actions are ‘erase’ (default) and ‘fill’.</p>
<p>Requires matplotlib and Python Image Library (PIL), but they are imported
here so that this function can be imported independently of the script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to fill or erase with hand-drawn polygons.</p></li>
<li><p><strong>action</strong> (<em>str</em><em>, </em><em>optional</em>) – If ==’fill’, will fill the drawn region. If ==’erase’, will erase the
drawn region. The default is ‘erase’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – The image with the hand-drawn polygon either filled or erased.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.im_connectivity">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">im_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#im_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.im_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an image of 8-connectivity for an input image of all pixels in a
binary image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iret</strong> – Image of 8-connectivity count for each pixel in the input image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.imshowpair">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">imshowpair</code><span class="sig-paren">(</span><em>I1</em>, <em>I2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#imshowpair"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.imshowpair" title="Permalink to this definition">¶</a></dt>
<dd><p>Overlays two binary images with a color scheme that shows their differences
and overlaps. Provides similar functionality to matlab’s imshowpair. Useful
for quick diagnostic of differences between two binary images.</p>
<p>This function will plot on current figure if it exists, else it will create
a new one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I1</strong> (<em>np.array</em>) – The first binary image.</p></li>
<li><p><strong>I2</strong> (<em>np.array</em>) – The second binary image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.largest_blobs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">largest_blobs</code><span class="sig-paren">(</span><em>I</em>, <em>nlargest=1</em>, <em>action='remove'</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#largest_blobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.largest_blobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides filtering for the largest blobs in a binary image. Can choose to
either keep or remove them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to filter.</p></li>
<li><p><strong>nlargest</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of blobs to filter. The default is 1.</p></li>
<li><p><strong>action</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘keep’, will keep the nlargest blobs. If ‘remove’, will remove the
nlargest blobs. The default is ‘remove’.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong> – The filtered image. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_idcs</code><span class="sig-paren">(</span><em>c</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the column, row coordinats of all eight neighbors of a given
column and row.</p>
<p>Returns are ordered as
[0 1 2</p>
<blockquote>
<div><p>3   4
5 6 7]</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cidcs</strong> (<em>list</em>) – Columns of the eight neighbors.</p></li>
<li><p><strong>ridcs</strong> (<em>TYPE</em>) – Rows of the eight neighbors.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_vals">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_vals</code><span class="sig-paren">(</span><em>I</em>, <em>c</em>, <em>r</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_vals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the neighbor values in I of a specified pixel coordinate. Handles
edge cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Image to draw values from.</p></li>
<li><p><strong>c</strong> (<em>int</em>) – Column defining pixel to find neighbor values.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row defining pixel to find neighbor values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vals</strong> – A flattened array of all the neighboring pixel values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbor_xy">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbor_xy</code><span class="sig-paren">(</span><em>c</em>, <em>r</em>, <em>idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbor_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbor_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of a neighbor of a pixel given the index of the
desired neighbor. Indices should be provided according to
[0 1 2</p>
<blockquote>
<div><p>3   4
5 6 7].</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column of the pixel to find the neighbor.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row of the pixel to find the neighbor.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Index of the neighbor position.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>c</strong> (<em>int</em>) – Column of the neighbor pixel.</p></li>
<li><p><strong>r</strong> (<em>int</em>) – Row of the neighbor pixel.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.neighbors_flat">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">neighbors_flat</code><span class="sig-paren">(</span><em>idx</em>, <em>imflat</em>, <em>ncols</em>, <em>filt='nonzero'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#neighbors_flat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.neighbors_flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all 8-neighbor pixel indices and values from an index of a
flattened image. Can filter out zero values with the filt keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index within imflat to return neighbors.</p></li>
<li><p><strong>imflat</strong> (<em>np.array</em>) – Flattened image (using np.ravel).</p></li>
<li><p><strong>ncols</strong> (<em>int</em>) – Number of columns in the un-flattened image.</p></li>
<li><p><strong>filt</strong> (<em>str</em><em>, </em><em>optional</em>) – If ‘nonzero’, only nonzero indices and values are returned. Else all
neighbors are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>idcs</strong> (<em>np.array</em>) – Indices within the flattened image of neighboring pixels.</p></li>
<li><p><strong>vals</strong> (<em>np.array</em>) – Values within the flattened image of neighboring pixels; matches idcs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.nfour_connectivity">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">nfour_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#nfour_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.nfour_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an image of four-connectivity for each pixel, where the pixel value
is the number of 4-connected neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.array</em>) – Binary image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Infc</strong> – Image of 4-connectivity for each pixel. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.regionprops">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">regionprops</code><span class="sig-paren">(</span><em>I</em>, <em>props</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#regionprops"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.regionprops" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds blobs within a binary image and returns requested properties of
each blob.</p>
<p>This function was modeled after matlab’s regionprops and is essentially
a wrapper for skimage’s regionprops. Not all of skimage’s available blob
properties are available here, but they can easily be added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image containing blobs.</p></li>
<li><p><strong>props</strong> (<em>list</em>) – Properties to compute for each blob. Can include ‘area’, ‘coords’,
‘perimeter’, ‘centroid’, ‘mean’, ‘perimeter’, ‘perim_len’, ‘convex_area’,
‘eccentricity’, ‘convex_area’, ‘major_axis_length’, ‘minor_axis_length’,
‘label’.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Keys of the dictionary correspond to the requested properties. Values
for each key are lists of that property, in order such that, e.g., the
first entry of each property’s list corresponds to the same blob.</p></li>
<li><p><strong>Ilabeled</strong> (<em>np.array</em>) – Image where each pixel’s value corresponds to its blob label. Labels
can be returned by specifying ‘label’ as a property.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.reglobalize_flat_idx">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">reglobalize_flat_idx</code><span class="sig-paren">(</span><em>idxlist</em>, <em>idxlistdims</em>, <em>row_offset</em>, <em>col_offset</em>, <em>globaldims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#reglobalize_flat_idx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.reglobalize_flat_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of indices from a subimage and returns their indices within
their parent image.</p>
<p>If idxlist is (x,y), then idxlistdims should be (dim_x, dim_y), etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idxlist</strong> (<em>np.array</em><em> or </em><em>list</em><em> or </em><em>set</em>) – List-like array of indices within the subimage.</p></li>
<li><p><strong>idxlistdims</strong> (<em>tuple</em>) – (nrows, ncols) of the subimage.</p></li>
<li><p><strong>row_offset</strong> (<em>int</em>) – The row in the parent image corresponding to the lowest row in the
subimage.</p></li>
<li><p><strong>col_offset</strong> (<em>int</em>) – The column in the parent image corresponding to the left-most column
in the subimage.</p></li>
<li><p><strong>globaldims</strong> (<em>tuple</em>) – (nrows, ncols) of the parent image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcsflat</strong> – The indices in indexlist in terms of the parent image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.remove_blobs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">remove_blobs</code><span class="sig-paren">(</span><em>I</em>, <em>blobthresh</em>, <em>connectivity=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#remove_blobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.remove_blobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove blobs of a binary image that are smaller than blobthresh. A blob is
simply a set of connected “on” pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to remove blobs from.</p></li>
<li><p><strong>blobthresh</strong> (<em>int</em>) – Minimum number of pixels a blob must contain for it to be kept.</p></li>
<li><p><strong>connectivity</strong> (<em>int</em><em>, </em><em>optional</em>) – If 1, 4-connectivity will be used to determine connected blobs. If
2, 8-connectivity will be used. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ic</strong> – Binary image with blobs filetered. Same shape as I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_branchpoints">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_branchpoints</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_branchpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_branchpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the branchpoints in a skeletonized image. Branchpoints are not simply
those with more than two neighbors; they are identified in a way that
minimizes the number of branchpoints required to resolve the skeleton
fully with the fewest number of branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Skeletonized image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ibps</strong> – Binary image of shape Iskel where only branchpoints are on.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_endpoints">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_endpoints</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_endpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_endpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all the endpoints of a skeleton.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Binary skeleton image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eps</strong> – Skeleton endpoint positions in (row, col) format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_kernels">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_kernels</code><span class="sig-paren">(</span><em>caseno</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_kernels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_kernels" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides kernels for convolving with skeleton image to remove the following case:</p>
<p>0 0 0
1 1 1
0 1 0</p>
<p>and its rotations. The center pixel would be removed as doing so
does not break connectivity of the skeleton.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>caseno</strong> (<em>int</em>) – Identifier for specific kernel cases. Can be 1-4.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>kernel</strong> – 3x3 kernel corresponding to the caseno.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.skel_pixel_curvature">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">skel_pixel_curvature</code><span class="sig-paren">(</span><em>Iskel</em>, <em>nwalk=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#skel_pixel_curvature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.skel_pixel_curvature" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an estimate of the curvature at most pixels within a skeleton image.
Not all pixels are considered; some boundary pixels (i.e. those
near the end of the skeleton) will not be computed. The more pruned and
thinned the input skeleton, the less likely that any strange values will
be returned. This code was written so that strange cases are merely
skipped.</p>
<p>Given an input skeleton image, the code looks at each pixel and fits a
trendline through npix pixels “upstream” and “downstream” of the pixel in
question. Scale is therefore set by npixels; larger will reduce
variability in the curvature estimates.</p>
<dl class="simple">
<dt>INPUTS:      Iskel - binary image of skeleton whose pixels you want</dt><dd><p>curvature values</p>
</dd>
</dl>
<p>OUTPUTS:         I - image of skeleton with curvature values at pixels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Iskel</strong> (<em>np.array</em>) – Binary skeleton image to compute curvatures.</p></li>
<li><p><strong>nwalk</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of pixels to walk away, in each direction, to define the
curve to compute a pixel’s curvature. Higher results in smoother
curvature values. The default is 4.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I</strong> – Image wherein pixel values represent the curvature of the skeleton.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.im_utils.trim_idcs">
<code class="descclassname">rivgraph.im_utils.</code><code class="descname">trim_idcs</code><span class="sig-paren">(</span><em>imshape</em>, <em>idcs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/im_utils.html#trim_idcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.im_utils.trim_idcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Trims a list of indices by removing the indices that cannot fit within a
raster of imshape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imshape</strong> (<em>tuple</em>) – Shape of image to filter idcs against.</p></li>
<li><p><strong>idcs</strong> (<em>np.array</em>) – Indices to ensure fit within an image of shape imshape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idcs</strong> – Indices that can fit within imshape.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.io_utils"></span><div class="section" id="io-utils">
<h2>io_utils<a class="headerlink" href="#io-utils" title="Permalink to this headline">¶</a></h2>
<p>Created on Sun Sep 16 15:15:18 2018</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.io_utils.centerline_to_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">centerline_to_geovector</code><span class="sig-paren">(</span><em>cl</em>, <em>crs</em>, <em>outpath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#centerline_to_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.centerline_to_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Centerline is already-projected Nx2 numpy array.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.coords_from_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">coords_from_geovector</code><span class="sig-paren">(</span><em>coordspath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#coords_from_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.coords_from_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Not called in classes.py</p>
<p>Retrieves centerline coordinates from shapefile.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.coords_to_geovector">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">coords_to_geovector</code><span class="sig-paren">(</span><em>coords</em>, <em>epsg</em>, <em>outpath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#coords_to_geovector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.coords_to_geovector" title="Permalink to this definition">¶</a></dt>
<dd><p>Not called in classes.py</p>
<p>Given a list or tuple of (x,y) coordinates and the EPSG code, writes the
coordinates to a shapefile.</p>
<p>This should be replaced by a geodataframe creation, but no use cases
yet…</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.create_manual_dir_csv">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">create_manual_dir_csv</code><span class="sig-paren">(</span><em>csvpath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#create_manual_dir_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.create_manual_dir_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a csv file for fixing links manually.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.meshpolys_to_geovectors">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">meshpolys_to_geovectors</code><span class="sig-paren">(</span><em>meshpolys</em>, <em>crs</em>, <em>outpath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#meshpolys_to_geovectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.meshpolys_to_geovectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports the meshpolys returned by centerline_mesh as a shapefile.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.prepare_paths">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">prepare_paths</code><span class="sig-paren">(</span><em>resultsfolder</em>, <em>name</em>, <em>basetiff</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#prepare_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.prepare_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a results folder, a delta or river name, and a filetype, generates
paths for saving results or intermediate files.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.io_utils.write_linkdirs_geotiff">
<code class="descclassname">rivgraph.io_utils.</code><code class="descname">write_linkdirs_geotiff</code><span class="sig-paren">(</span><em>links</em>, <em>gd_obj</em>, <em>writepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/io_utils.html#write_linkdirs_geotiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.io_utils.write_linkdirs_geotiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a geotiff where links are colored according to their directionality.
Pixels in each link are interpolated between 0 and 1 such that the upstream
pixel is 0 and the downstream-most pixel is 1. In a GIS, color can then
be set to see directionality.</p>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.ln_utils"></span><div class="section" id="ln-utils">
<h2>ln_utils<a class="headerlink" href="#ln-utils" title="Permalink to this headline">¶</a></h2>
<p>Created on Mon Sep 10 09:59:52 2018</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.ln_utils.add_artificial_nodes">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">add_artificial_nodes</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#add_artificial_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.add_artificial_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Some graphical metrics fail for graphs that contain parallel links, or
links that share the same end nodes. This function alleviates that issue
by inserting artificial nodes into all but one of the parallel links. The
shortest link of the parallel set will not receive an artificial node.</p>
<p>For simplicity of coding, when a node is added, the old link is deleted and
two new links are put in its place.</p>
<p>If flow directions have been set for links, the properties of the link that
is broken into two are appended to the two parts. This may result in some
properties that are no longer correct, e.g. slope.</p>
<p>This function should not be run prior to setting flow directions.</p>
<p>The ‘guess’ attribute of the links where artificial nodes are added
will be incorrect as it doesn’t account for the artificial node, but
references the original end nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>nodes</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>gd_obj</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>nodes</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.adjust_for_padding">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">adjust_for_padding</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>npad</em>, <em>dims</em>, <em>initial_dims</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#adjust_for_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.adjust_for_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjusts links[‘idx’] and nodes[‘idx’] values back to original image
dimensions, effectively removing the padding.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.append_link_lengths">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">append_link_lengths</code><span class="sig-paren">(</span><em>links</em>, <em>gd_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#append_link_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.append_link_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends link lengths to each link.</p>
<p>5/27/2020 Due to dummy projection problems, removing the transformation
of coordinates to 4087. Lengths and widths will be computed in units of
the provided CRS. If you want to change this in the future, will need
to pass a dummy flag to notify that coordinates should not be transformed
for those cases.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.conn_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">conn_links</code><span class="sig-paren">(</span><em>nodes</em>, <em>links</em>, <em>node_idx</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#conn_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.conn_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first and last pixels of links connected to node_idx.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.find_art_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">find_art_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#find_art_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.find_art_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the triplet of links corresponding to each artificial nodes in
nodes[‘arts’].</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.find_parallel_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">find_parallel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#find_parallel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.find_parallel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all parallel links within the graph. A set of parallel links all have
the same start and end node. Parallel links are added as an attribute to
the links dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>nodes</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.flip_link">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">flip_link</code><span class="sig-paren">(</span><em>links</em>, <em>linkid</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#flip_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.flip_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Flips a link’s direction and updates corresponding connectivity and other
attributes.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.junction_angles">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">junction_angles</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em>, <em>imshape</em>, <em>pixlen</em>, <em>weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#junction_angles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.junction_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes junction angles between links in a directed graph. Only junctions
with three joining links are considered for simplicity. Also computes
the ratio of link widths at junctions, and determines whether the junction
is a confluence (joining) or a bifurcation (diverging). These attributes
are appended to the provided nodes dictionary.
‘weight’ can be ‘None’, ‘exp’ (exponential), or ‘lin’ (linear)</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.link_widths_and_lengths">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">link_widths_and_lengths</code><span class="sig-paren">(</span><em>links</em>, <em>Idt</em>, <em>pixlen=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#link_widths_and_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.link_widths_and_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends link widths and lengths to the links dictionary.
There is a slight twist. When a skeleton is computed for a very wide
channel with a narrow tributary, there is a very straight section of the
skeleton as it leaves the wide channel to go into the tributary; this
straight section should not be used to compute average link width, as it’s
technically part of the wide channel. The twist here accounts for that by
elminating the ends of the each link from computing widths and lengths,
where the distance along each end is equal to the half-width of the endmost
pixels.
##TODO: add median width OR just change wid_adj to be median?</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.links_to_gpd">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">links_to_gpd</code><span class="sig-paren">(</span><em>links</em>, <em>gdobj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#links_to_gpd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.links_to_gpd" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts links dictionary to a geopandas dataframe.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.node_updater">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">node_updater</code><span class="sig-paren">(</span><em>nodes</em>, <em>idx</em>, <em>conn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#node_updater"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.node_updater" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates node dictionary. Supply index of node and connected link.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_duplicate_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_duplicate_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_duplicate_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_duplicate_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks links for duplicates and removes any found. They are rare but some
have appeared in one-pixel-long links.</p>
</dd></dl>

<dl class="function">
<dt id="rivgraph.ln_utils.remove_single_pixel_links">
<code class="descclassname">rivgraph.ln_utils.</code><code class="descname">remove_single_pixel_links</code><span class="sig-paren">(</span><em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ln_utils.html#remove_single_pixel_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ln_utils.remove_single_pixel_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Thanks to the Lena for finding this bug. In very rare cases, we can end
up with a link of one pixel. This function removes those.</p>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.mask_to_graph"></span><p>Functions for converting a binary channel mask to a graphical representation.</p>
<dl class="function">
<dt id="rivgraph.mask_to_graph.pad_river_im">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">pad_river_im</code><span class="sig-paren">(</span><em>I</em>, <em>es</em>, <em>pm=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#pad_river_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.pad_river_im" title="Permalink to this definition">¶</a></dt>
<dd><p>Pads the edges of a binary river image by extending the ends of the river.
Different than mirrored padding in that the “mirror” here is just a
rectangle. This simplifies skeletonization and interpretation in cases
where the channel is complex near the boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.array</em>) – Binary image to pad; typically a river channel network.</p></li>
<li><p><strong>es</strong> (<em>str</em>) – A two-character string (from N, E, S, or W) that denotes which sides
of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’,
‘NW’, etc.</p></li>
<li><p><strong>pm</strong> (<em>int</em><em>, </em><em>optional</em>) – Pad multiplier that sets the size of the padding. Multplies the blob
size along the axis of the image that the blob intersect to determine
the padding distance. The default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Ip</strong> (<em>np.array</em>) – The padded image..</p></li>
<li><p><strong>pads</strong> (<em>list</em>) – 4 entry list containing the number of pixels padded on the [n, s, e, w]
edges of the image.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.simplify_skel">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">simplify_skel</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#simplify_skel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.simplify_skel" title="Permalink to this definition">¶</a></dt>
<dd><p>This function iterates through all skeleton pixels pixels that have
connectivity &gt; 2. It removes the pixel and checks if the
number of blobs has changed after removal. If so, the pixel is necessary to
maintain connectivity. Otherwise the pixel is not retained. It also adds
pixels to the centers of “+” cases, as this reduces the number
of branchpoints from 4 to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.array</em>) – Image of the skeleton to simplify.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iskel</strong> – The simplified skeleton.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skel_to_graph">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skel_to_graph</code><span class="sig-paren">(</span><em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skel_to_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skel_to_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves a skeleton into its consitutent links and nodes.
This function finds a starting point to walk along a skeleton, then begins
the walk. Rules are in place to ensure the network is fully resolved. One
of the key algorithms called by this function involves the identfication of
branchpoints in a way that eliminates unnecessary ones to create a parsimonious
network. Rules are baked in for how to walk along the skeleton in cases
where multiple branchpoints are clustered or there are multiple possible
links to walk along.</p>
<p>Note that some minor adjustments to the skeleton may be made in order to
reduce the complexity of the network. For example, in the case of a “+”
with a missing center pixel in the skeleton, this function will add the
pixel to the center to enable the use of a single branchpoint as opposed to
four.</p>
<p>The takeaway is that there is no guarantee that the input skeleton will
be perfectly preserved when network-ifying. One possible workaround, if
perfect preservation is required, is to resample the skeleton to double the
resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Binary image of a skeleton.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>links</strong> (<em>dict</em>) –</p>
<dl>
<dt>Links of the network with four properties:</dt><dd><p>’id’ - a list of unique ids for each link in the network
‘idx’ - a list containing the pixel indices within Iskel that</p>
<blockquote>
<div><p>defines the link. These are ordered.</p>
</div></blockquote>
<dl class="simple">
<dt>’conn’ - a list of 2-element lists containing the node ids that</dt><dd><p>the link is connected to.</p>
</dd>
<dt>’n_networks’ - the number of disconnected networks found in the</dt><dd><p>skeleton</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p><strong>nodes</strong> (<em>dict</em>) –</p>
<dl>
<dt>Nodes of the network with four properties:</dt><dd><p>’id’ - a list of unique ids for each node in the network
‘idx’ - the index within Iskel of the node location
‘conn’ - a list of lists containing the link ids connected to this</p>
<blockquote>
<div><p>node</p>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skeletonize_mask">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skeletonize_mask</code><span class="sig-paren">(</span><em>Imask</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skeletonize_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skeletonize_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Skeletonizes an input binary image, typically a mask. Also performs some
skeleton simplification by (1) removing pixels that don’t alter connectivity,
and (2) filling small skeleton holes and reskeletonizing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Imask</strong> (<em>np.array</em>) – Binary image to be skeletonized.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Iskel</strong> – The skeletonization of Imask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.mask_to_graph.skeletonize_river_mask">
<code class="descclassname">rivgraph.mask_to_graph.</code><code class="descname">skeletonize_river_mask</code><span class="sig-paren">(</span><em>I</em>, <em>es</em>, <em>padscale=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_to_graph.html#skeletonize_river_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_to_graph.skeletonize_river_mask" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Skeletonizes a binary mask of a river channel network. Differs from
skeletonize mask above by using knowledge of the exit sides of the river
with respect to the mask (I) to avoid edge effects of skeletonization by
mirroring the mask at its ends, then trimming it after processing. As with
skeletonize_mask, skeleton simplification is performed.</p>
<dl>
<dt>INPUTS:</dt><dd><blockquote>
<div><p>I - binary river mask to skeletonize</p>
</div></blockquote>
<dl class="simple">
<dt>es - NSEW “exit sides” corresponding to the upstream and downstream</dt><dd><p>sides of the image that intersect the river. e.g. ‘NS’, ‘EN’, ‘WS’</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>padscale - (Optional) number of pixels to reflect I before skeletonization</dt><dd><blockquote>
<div><p>to remove edge effects of skeletonization</p>
</div></blockquote>
<dl class="simple">
<dt>I<span class="classifier">np.array</span></dt><dd><p>Binary river mask to skeletonize.</p>
</dd>
<dt>es<span class="classifier">str</span></dt><dd><p>A two-character string (from N, E, S, or W) that denotes which sides
of the image the river intersects (upstream first) – e.g. ‘NS’, ‘EW’,
‘NW’, etc.</p>
</dd>
<dt>padscale<span class="classifier">int, optional</span></dt><dd><p>Pad multiplier that sets the size of the padding. Multplies the blob
size along the axis of the image that the blob intersect to determine
the padding distance. The default is 2.</p>
</dd>
</dl>
<dl class="simple">
<dt>Iskel<span class="classifier">np.array</span></dt><dd><p>The skeletonization of I.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-rivgraph.mask_utils"></span><p>Created on Mon Jul  6 18:29:23 2020</p>
<p>&#64;author: Jon</p>
<dl class="function">
<dt id="rivgraph.mask_utils.pixagon">
<code class="descclassname">rivgraph.mask_utils.</code><code class="descname">pixagon</code><span class="sig-paren">(</span><em>c_cent</em>, <em>r_cent</em>, <em>pixlen</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/mask_utils.html#pixagon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.mask_utils.pixagon" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a shapely polygon
of a provided center coordinate given the pixel resolution (pixlen).</p>
</dd></dl>

<span class="target" id="module-rivgraph.ordered_set"></span><div class="section" id="ordered-set">
<h2>ordered_set<a class="headerlink" href="#ordered-set" title="Permalink to this headline">¶</a></h2>
<p>An OrderedSet is a custom MutableSet that remembers its order, so that every
entry has an index that can be looked up.</p>
<p>Based on a recipe originally posted to ActiveState Recipes by Raymond Hettiger,
and released under the MIT license.</p>
<dl class="class">
<dt id="rivgraph.ordered_set.OrderedSet">
<em class="property">class </em><code class="descclassname">rivgraph.ordered_set.</code><code class="descname">OrderedSet</code><span class="sig-paren">(</span><em>iterable=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet" title="Permalink to this definition">¶</a></dt>
<dd><p>An OrderedSet is a custom MutableSet that remembers its order, so that
every entry has an index that can be looked up.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">OrderedSet([1, 2, 3])</span>
</pre></div>
</div>
<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__contains__">
<code class="descname">__contains__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__contains__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if the item is in this ordered set</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="ow">in</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">5</span> <span class="ow">in</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__eq__">
<code class="descname">__eq__</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__eq__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the containers have the same items. If <cite>other</cite> is a
Sequence, then order is checked, otherwise it is ignored.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">==</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__getitem__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the item at a given index.</p>
<p>If <cite>index</cite> is a slice, you will get back that slice of items. If it’s
the slice [:], a copy of this object is returned.</p>
<p>If <cite>index</cite> is a list or a similar iterable, you’ll get the OrderedSet
of items corresponding to those indices. This is similar to NumPy’s
“fancy indexing”.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>iterable=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__iter__">
<code class="descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__iter__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])))</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__len__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of unique elements in the ordered set</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([]))</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__repr__">
<code class="descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.__reversed__">
<code class="descname">__reversed__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.__reversed__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__reversed__" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])))</span>
<span class="go">[3, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="rivgraph.ordered_set.OrderedSet.__weakref__">
<code class="descname">__weakref__</code><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add <cite>key</cite> as an item to this OrderedSet, then return its index.</p>
<p>If <cite>key</cite> is already in the OrderedSet, return the index it already
had.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Add <cite>key</cite> as an item to this OrderedSet, then return its index.</p>
<p>If <cite>key</cite> is already in the OrderedSet, return the index it already
had.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all items from this OrderedSet.</p>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a shallow copy of this object.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>*sets</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.difference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all elements that are in this set but not the others.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">OrderedSet([1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<span class="go">OrderedSet([1, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.difference_update">
<code class="descname">difference_update</code><span class="sig-paren">(</span><em>*sets</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.difference_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of self with items from other removed</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.discard">
<code class="descname">discard</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.discard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an element.  Do not raise an exception if absent.</p>
<p>The MutableSet mixin uses this to implement the .remove() method, which
<em>does</em> raise an error when asked to remove a non-existent item.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the index of a given entry, raising an IndexError if it’s not
present.</p>
<p><cite>key</cite> can be an iterable of entries that is not a string, in which case
this returns a list of indices.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.intersection">
<code class="descname">intersection</code><span class="sig-paren">(</span><em>*sets</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.intersection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns elements in common between all sets. Order is defined only
by the first set.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">intersection</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">OrderedSet([2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">OrderedSet([1, 2, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.intersection_update">
<code class="descname">intersection_update</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.intersection_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.intersection_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a set with the intersection of itself and another.
Order depends only on the first element</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">intersection_update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 3, 7])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.issubset">
<code class="descname">issubset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.issubset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>Report whether another set contains this set.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">})</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">issubset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">})</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.issuperset">
<code class="descname">issuperset</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.issuperset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>Report whether this set contains another set.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">issuperset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">issuperset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">})</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">issuperset</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">})</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.pop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove and return the last element from the set.</p>
<p>Raises KeyError if the set is empty.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.symmetric_difference">
<code class="descname">symmetric_difference</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.symmetric_difference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symmetric difference of two sets as a new set.
(I.e. all elements that are in exactly one of the sets.)</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">OrderedSet([4, 5, 9, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.symmetric_difference_update">
<code class="descname">symmetric_difference_update</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.symmetric_difference_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.symmetric_difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a set with the intersection of itself and another.
Order depends only on the first element</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">symmetric_difference_update</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([4, 5, 9, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.union">
<code class="descname">union</code><span class="sig-paren">(</span><em>*sets</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.union"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines all unique items.
Each items order is defined by its first appearance.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([3, 1, 4, 5, 2, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="go">OrderedSet([3, 1, 4, 5, 2, 0, 8, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">|</span> <span class="p">{</span><span class="mi">10</span><span class="p">}</span>
<span class="go">OrderedSet([3, 1, 4, 5, 2, 0, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OrderedSet</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="go">OrderedSet([1, 2, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rivgraph.ordered_set.OrderedSet.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#OrderedSet.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.OrderedSet.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the set with the given iterable sequence, then return the index
of the last element inserted.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span> <span class="o">=</span> <span class="n">OrderedSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="go">OrderedSet([1, 2, 3, 5, 4])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="rivgraph.ordered_set.is_iterable">
<code class="descclassname">rivgraph.ordered_set.</code><code class="descname">is_iterable</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/ordered_set.html#is_iterable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.ordered_set.is_iterable" title="Permalink to this definition">¶</a></dt>
<dd><p>Are we being asked to look up a list of things, instead of a single thing?
We check for the <cite>__iter__</cite> attribute so that this can cover types that
don’t have to be known by this module, such as NumPy arrays.</p>
<p>Strings, however, should be considered as atomic values to look up, not
iterables. The same goes for tuples, since they are immutable and therefore
valid entries.</p>
<p>We don’t need to check for the Python 2 <cite>unicode</cite> type, because it doesn’t
have an <cite>__iter__</cite> attribute anyway.</p>
</dd></dl>

</div>
<span class="target" id="module-rivgraph.walk"></span><div class="section" id="walk-py">
<h2>walk.py<a class="headerlink" href="#walk-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for walking along skeletons and finding branchpoints.</p>
<p>Created on Mon Sep 10 09:39:19 2018</p>
<dl class="function">
<dt id="rivgraph.walk.bp_cluster">
<code class="descclassname">rivgraph.walk.</code><code class="descname">bp_cluster</code><span class="sig-paren">(</span><em>bp</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#bp_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.bp_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds clusters of branchpoints; i.e. branchpoints that are immediately
adjacent to each other in an 8-connected sense. This function is self-
referential in order to find all neighboring branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bp</strong> (<em>list</em>) – Contains the branchpoint cluster as indices (np.ravel_multi_index)
within Iskel. In the initial call, this list contains only a single
branchpoint.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bp</strong> – Contains the branchpoint cluster as indices (np.ravel_multi_index)
within Iskel.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.cant_walk">
<code class="descclassname">rivgraph.walk.</code><code class="descname">cant_walk</code><span class="sig-paren">(</span><em>links</em>, <em>linkidx</em>, <em>nodes</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#cant_walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.cant_walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an input link defined by linkidx, return all the pixels that cannot be walked
to. These include:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>originating node (and any nodes adjacent to this one)</p></li>
<li><p>emanating links (i.e. first pixel away from each node)</p></li>
<li><p>links that have been resolved walking AWAY from the node (toward node not included)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>linkidx</strong> (<em>int</em>) – Index of the link id within links[‘id’] of the link to analyze.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>walked</strong> – Indices of pixels within Iskel that have already been walked to.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.check_dup_links">
<code class="descclassname">rivgraph.walk.</code><code class="descname">check_dup_links</code><span class="sig-paren">(</span><em>linkid</em>, <em>links</em>, <em>nodes</em>, <em>links2do</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#check_dup_links"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.check_dup_links" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks that the link represented by linkid has no dubplicates in the
network. If so, the link is removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Id of the link to check for duplication.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>links2do</strong> (<a class="reference internal" href="#rivgraph.ordered_set.OrderedSet" title="rivgraph.ordered_set.OrderedSet"><em>OrderedSet</em></a>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in mask_to_graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with duplicate link removed, if
it existed.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with duplicate ilnk removed, if
it existed.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in mask_to_graph.
The duplicate link, if found, is removed from this set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.delete_link">
<code class="descclassname">rivgraph.walk.</code><code class="descname">delete_link</code><span class="sig-paren">(</span><em>linkid</em>, <em>links</em>, <em>nodes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#delete_link"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.delete_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a link from the links dictionary and updates the nodes dictionary
to account for the deleted link. This is a special case of the delete_link
found in ln_utils.py, as no properties have been added yet. It is possible
that this function could be replaced by that one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Id of the link to delete.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties with the link deleted.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties with the link deleted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.find_emanators">
<code class="descclassname">rivgraph.walk.</code><code class="descname">find_emanators</code><span class="sig-paren">(</span><em>bpnode</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#find_emanators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.find_emanators" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all possible next steps along the skeleton from a given pixel.
Emanators are the second nodes in each link, or the first nodes away from
the link endpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bpnode</strong> (<em>np.int</em>) – Index within Iskel to look for emanators.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>all_emanators</strong> – Indices within Iskel representing emanating nodes from bpnode.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.get_neighbors">
<code class="descclassname">rivgraph.walk.</code><code class="descname">get_neighbors</code><span class="sig-paren">(</span><em>idx</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#get_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.get_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a flattened array of the neighboring pixel indices within Iskel
that are True. Only looks at 8-connected neighbors (i.e. a 3x3 kernel with
centered on idx).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.int</em>) – Index within Iskel to get neighbors.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask, but can be any image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>neighbor_idcs_gloal</strong> – Indices within Iskel of True pixels bordering idx.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.handle_bp">
<code class="descclassname">rivgraph.walk.</code><code class="descname">handle_bp</code><span class="sig-paren">(</span><em>linkid</em>, <em>bpnode</em>, <em>nodes</em>, <em>links</em>, <em>links2do</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#handle_bp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.handle_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>When walking along a skeleton and encountering a branchpoint, we want to
initialize all un-done links emanating from the branchpoint. Each new link
contains the branchpoint as the first index, and this function also takes
the first step of the link.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>linkid</strong> (<em>int</em>) – Link id of the link walking from.</p></li>
<li><p><strong>bpnode</strong> (<em>np.int</em>) – Node id of the branchpoint to be resolved.</p></li>
<li><p><strong>nodes</strong> (<em>dict</em>) – Network nodes and associated properties.</p></li>
<li><p><strong>links</strong> (<em>dict</em>) – Network links and associated properties.</p></li>
<li><p><strong>links2do</strong> (<a class="reference internal" href="#rivgraph.ordered_set.OrderedSet" title="rivgraph.ordered_set.OrderedSet"><em>OrderedSet</em></a>) – This set keeps track of all the links that still need to be resolved
in the full skeleton. It is generated and populated in mask_to_graph.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the local skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>links</strong> (<em>TYPE</em>) – Network links and associated properties with the branchpoint links
added.</p></li>
<li><p><strong>nodes</strong> (<em>TYPE</em>) – Network nodes and associated properties with the branchpoint-related
nodes added.</p></li>
<li><p><strong>links2do</strong> (<em>OrderedSet</em>) – Same as input, but with new link emanators added and linkid removed.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.idcs_no_turnaround">
<code class="descclassname">rivgraph.walk.</code><code class="descname">idcs_no_turnaround</code><span class="sig-paren">(</span><em>idcs</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#idcs_no_turnaround"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.idcs_no_turnaround" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of possible indices to walk toward given two input indices
(idcs).</p>
<p>Possible indices are defined as those which require no turning around;
e.g. if moving down, only indices further below idcs[1] will be returned.
Based on directionality, only three possible indices should be returned
for all cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idcs</strong> (<em>list</em>) – Resolved indices within Iskel of the link, in order, for which the next
step needs to be taken.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>poss_walk_idcs</strong> – Indices within Iskel of possible next steps that ensure the walk will
not move “backwards.”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.is_bp">
<code class="descclassname">rivgraph.walk.</code><code class="descname">is_bp</code><span class="sig-paren">(</span><em>idx</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#is_bp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.is_bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the index given by idx is a branchpoint. Branchpoints are
not simply pixels in the skeleton with more than two neighbors; they are
pruned through a somewhat complicated procedure that minimizes the number
of required branchpoints to preserve the skeleton topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>np.int</em>) – Index within Iskel to determine if it is a branchpoint.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask, but can be any image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>isbp</strong> – 1 if idx is a branchpoint, else 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.isbp_parsimonious">
<code class="descclassname">rivgraph.walk.</code><code class="descname">isbp_parsimonious</code><span class="sig-paren">(</span><em>Ic</em>, <em>Icr</em>, <em>Inar</em>, <em>Infr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#isbp_parsimonious"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.isbp_parsimonious" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes parsimonious set of branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ic</strong> (<em>np.ndarray</em>) – Image of possible branchpoints; values correspond to number of
neighbors.</p></li>
<li><p><strong>Icr</strong> (<em>np.ndarray</em>) – Raveled (np.ravel) version of Ic.</p></li>
<li><p><strong>Inar</strong> (<em>np.ndarray</em>) – Raveled version of image returned by naxes_connectivity.</p></li>
<li><p><strong>Infr</strong> (<em>np.ndarray</em>) – Raveled version of image returned by nfour_connectivity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bps</strong> – All branchpoint indices within Ic.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.isbp_walk_for_bps">
<code class="descclassname">rivgraph.walk.</code><code class="descname">isbp_walk_for_bps</code><span class="sig-paren">(</span><em>I</em>, <em>bpi</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#isbp_walk_for_bps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.isbp_walk_for_bps" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds branchpoints by ensuring that all pixels in the sub-skeleton can be
walked to from the set of already-found branchpoints, without visiting
the same pixel more than once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I</strong> (<em>np.ndarray</em>) – Binary image of a skeleton. In RivGraph, the skeleton is a reduced and
padded version of Iskel.</p></li>
<li><p><strong>bpi</strong> (<em>list</em>) – Indices within I of the branchpoint to begin walk.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bpi</strong> – Branchpoint indices in I.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.naxes_connectivity">
<code class="descclassname">rivgraph.walk.</code><code class="descname">naxes_connectivity</code><span class="sig-paren">(</span><em>I</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#naxes_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.naxes_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the number of axes of connectivity for each pixel in an input
skeleton. The maximum is four; horizontal, vertical, and two diagonals.</p>
<p>The number of axes of pixel connectivity is used to determine where to
place branchpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>I</strong> (<em>np.ndarray</em>) – Binary image of a skeleton. In RivGraph, the skeleton is a reduced and
padded version of Iskel.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Inax</strong> – Same shape as I; values correspond to the number of axes represented
by each pixel’s connectivity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="rivgraph.walk.walkable_neighbors">
<code class="descclassname">rivgraph.walk.</code><code class="descname">walkable_neighbors</code><span class="sig-paren">(</span><em>link</em>, <em>Iskel</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rivgraph/walk.html#walkable_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rivgraph.walk.walkable_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the walkable neighbors from the end pixel of an input link.
Walkable neighbors are simply pixels that are “on” within Iskel. The pixels
in the link are excluded as possibilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>link</strong> (<em>list</em>) – Contains all the pixel indices within Iskel of the link to find
walkable neighbors.</p></li>
<li><p><strong>Iskel</strong> (<em>np.ndarray</em>) – Image of the skeletonized mask.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>neighs</strong> – Indices within Iskel of neighboring pixels to walk to.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deltas.html" class="btn btn-neutral float-right" title="deltas" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, J. Schwenk &amp; J. Hariharan

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>